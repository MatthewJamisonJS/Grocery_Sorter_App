#!/usr/bin/env ruby

# Grocery Sorter App - Smart Launcher
# This script automatically handles setup and launches the app

require 'fileutils'

class GrocerySorterLauncher
  def initialize
    @config_dir = File.join(Dir.pwd, 'config')
  end

  def launch
    puts "ðŸ›’ Grocery Sorter App"
    puts "=" * 30

    # Check if basic setup is needed
    if setup_needed?
      puts "ðŸ”§ First-time setup detected..."
      puts "   Running basic setup..."
      puts ""

      # Run the setup script
      system("ruby script/setup.rb")

      puts ""
      puts "âœ… Setup complete! Launching app..."
      puts ""
    end

    # Launch the main app
    puts "ðŸš€ Starting Grocery Sorter App..."
    puts "   No authentication required!"
    puts "   Google Docs integration is disabled"
    puts "   Core functionality is available"
    puts ""
    system("ruby script/grocery_sorter.rb")
  end

  private

  def setup_needed?
    # Only check for basic Rails setup, not Google credentials
    !File.exist?(File.join(@config_dir, 'application.rb'))
  end

  def setup_complete?
    # Basic setup is complete if Rails config exists
    File.exist?(File.join(@config_dir, 'application.rb'))
  end
end

# Run the launcher
if __FILE__ == $0
  launcher = GrocerySorterLauncher.new
  launcher.launch
end
